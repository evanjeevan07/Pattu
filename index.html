<!DOCTYPE html>
<html lang="ta">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Thinklator тАС рооро╛род ро╡роЯрпНроЯро┐ роХрогро┐рокрпНрокро╛ройрпН</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Pacifico&family=Mukta+Malar:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Font Awesome for Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

  <style>
    body {
      font-family: 'Mukta Malar', sans-serif;
    }

    .brand-text {
      font-family: 'Abril Fatface', cursive;
      font-weight: bold;
      font-size: 1.5rem;
      color: white;
      margin-left: -10px;
    }

    /* Original shimmer for the Calculate button */
    .shimmer {
      background: linear-gradient(90deg, #4ade80, #22c55e, #4ade80);
      background-size: 200% 100%;
      animation: shimmer 2s infinite; /* Infinite animation */
      color: #fff;
    }

    @keyframes shimmer { /* Original shimmer animation */
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

     /* New keyframes for download button hover effect */
     /* Note: Download button CSS below redefines background, but animation keys are here */
    @keyframes shimmer-effect-download {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }


    .footer-animate {
      border-top: 2px solid;
      border-image: linear-gradient(to right, #16a34a, #86efac);
      border-image-slice: 1;
    }

    .nav-with-slide {
      position: relative;
      overflow: hidden;
      background-color: #40d777;
    }

    .nav-with-slide::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      width: 150px;
      background-color: #bbf7d1;
      z-index: 0;
      clip-path: polygon(0 0, 90% 0, 65% 100%, 0 100%);
    }

    .brand {
      position: relative;
      z-index: 1;
      display: flex;
      align-items: center;
    }

    .brand img {
      height: 56px;
      margin-left: 10px;
      margin-right: 8px;
    }

    .nav-content {
      position: relative;
      z-index: 1;
      color: white;
    }

    /* --- Receipt CSS Styles Start --- */
    /* Apply Abril Fatface specifically to English text elements */
    .english-font {
        font-family: 'Abril Fatface', cursive;
    }

    #receiptContainerWrapper {
        /* Styles for the container holding the receipt and print button */
        /* Initially hidden */
        display: none; /* Changed from 'none !important' for JS flexibility */
        flex-direction: column;
        align-items: center;
        padding: 20px;
        margin-top: 2rem;
        margin-bottom: 20px;
    }

    .receipt-container {
        background-color: #fff; /* Main container is white */
        border: 1px solid #ccc;
        border-radius: 10px;
        padding: 0 20px;
        max-width: 400px;
        width: 95%;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); /* Shadow like the output box */
        margin-bottom: 20px; /* Space between receipt and button */
        overflow: hidden;
    }

    /* Specific border radius for the top green section */
     .receipt-container > .green-section-bg:first-child {
         border-top-left-radius: 10px;
         border-top-right-radius: 10px;
         border-bottom-left-radius: 0; /* Ensure bottom is square */
         border-bottom-right-radius: 0; /* Ensure bottom is square */
     }

     /* Specific border radius for the bottom green section */
      .receipt-container > .green-section-bg:last-child {
         border-top-left-radius: 0; /* Ensure top is square */
         border-top-right-radius: 0; /* Ensure top is square */
         border-bottom-left-radius: 10px;
         border-bottom-right-radius: 10px;
     }

     /* Reapply green background style */
    .green-section-bg {
         background-color: #bbf7d1;
         padding: 10px 20px;
         margin: 0 -20px; /* Extend background to edge of receipt-container */
         /* Remove border radius from here to apply specifically to first/last children */
         border-radius: 0;
    }


    .receipt-header {
        text-align: center;
        margin-bottom: 0;
        padding-bottom: 5px;
    }

    .brand-receipt {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 5px;
    }

    .brand-logo {
        width: 40px;
        height: auto;
        margin-right: 8px;
    }

    .brand-receipt h2 {
        font-size: 1.5em;
        margin: 0;
        color: #29ca64;
        font-family: 'Abril Fatface', cursive;
    }

    .receipt-title {
        font-size: 1em;
        color: #29ca64;
        margin-top: 0;
        margin-bottom: 0;
    }

    .date-time-section {
        text-align: center;
        margin-bottom: 0;
        padding-bottom: 10px;
    }

    .date-time {
        font-size: 0.9em;
        color: #4CAF50;
        margin: 0;
    }

    .dashed-separator {
       border-bottom: 1px dashed #ccc;
       margin: 10px auto 10px auto;
       width: 100%;
    }

    .section {
        margin-bottom: 20px;
        padding-top: 10px;
    }

    .section-title {
        font-size: 1.1em;
        font-weight: bold;
        margin-top: 0;
        margin-bottom: 10px;
        padding-bottom: 5px;
        border-bottom: 1px dashed #ccc;
        color: #2c3440;
    }

    .detail-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
        font-size: 0.95em;
    }

    .detail-row .label {
        color: #2c3440;
    }

     .detail-row .value {
        color: #2c3440;
        text-align: right;
    }

     .final-amount-row-item {
         display: flex;
         justify-content: space-between;
         margin-bottom: 5px;
         font-size: 1.1em;
         font-weight: bold;
         color: #4CAF50;
         padding-top: 10px;
         padding-bottom: 5px;
     }

      .final-amount-row-item .value {
         color: #4CAF50;
      }

    .receipt-footer-content {
        text-align: center;
        font-size: 0.8em;
        color: #29ca64;
    }

     .receipt-footer-content p {
         margin: 3px 0;
     }

     .receipt-footer-content p:last-child {
          font-family: 'Abril Fatface', cursive;
     }

    .download-button {
        display: flex;
        align-items: center;
        justify-content: center;
        /* Base green background, keep original for non-hover */
        background-color: #4CAF50;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1em;
        overflow: hidden;
        position: relative;
        /* Transition for smoother hover color/background changes if not using animation */
        transition: background-color 0.3s ease;
    }

     /* Apply shimmer animation on hover/active */
    .download-button:hover,
    .download-button:active {
        animation: shimmer-effect-download 1.5s linear infinite; /* Apply animation on hover/active */
        /* Use the gradient from the original shimmer */
        background: linear-gradient(90deg, #bbf7d1, #4ade80, #bbf7d1);
        background-size: 200% 100%;
        color: #fff; /* Ensure text stays white during animation */
    }
     /* Ensure text stays white when not hovered */
    .download-button:not(:hover):not(:active) {
        color: white;
        /* Reset animation and background-position when not hovered/active */
        animation: none;
        background-position: 0% 0;
        /* Base background-color should be defined */
        background-color: #4CAF50; /* Explicitly set base color */
    }


    .download-button i {
        margin-right: 8px;
        color: inherit; /* Inherit color from button text */
        font-size: 1em;
    }

    /* Styles for printing */
    @media print {
        body {
            background-color: #fff; /* White background for printing */
            padding: 0;
            margin: 0;
            display: block; /* Override flex for printing */
            min-height: auto;
        }
         /* Hide elements not needed in print */
        .nav-with-slide, header, main, footer, .download-button {
            display: none;
        }
        #receiptContainerWrapper {
             /* Ensure the receipt is shown and styled for print */
             display: block !important; /* Override JS 'none' */
             padding: 0;
             margin: 0 auto; /* Center the receipt */
             max-width: 400px; /* Keep max width */
        }
        .receipt-container {
            box-shadow: none; /* No shadow on print */
            border: none; /* No border on print */
            border-radius: 0;
            max-width: 100%; /* Use full width available within wrapper */
            width: auto;
            margin: 0; /* Remove margins */
            padding: 0 10mm; /* Use physical units for print horizontal padding */
        }
         .green-section-bg {
             padding: 5mm 10mm; /* Use physical units for print padding */
             margin: 0 -10mm; /* Adjust negative margin for print padding */
             /* Remove border radius on print */
              border-radius: 0 !important;
         }
         .dashed-separator { /* Adjust print margin for the dashed separator */
             margin: 5mm auto; /* Adjust margin for print */
         }
          /* Adjusted section/title/row padding/margins for print readability */
         .section {
             padding-top: 5mm;
             margin-bottom: 10mm;
         }
          .section-title {
             padding-bottom: 2mm;
             margin-bottom: 5mm;
          }
          .detail-row {
             margin-bottom: 3mm;
          }
           .final-amount-row-item {
              padding-top: 5mm;
              padding-bottom: 2mm;
           }
    }
    /* --- CSS Styles End --- */
  </style>
</head>

<body class="bg-gradient-to-br from-green-50 to-green-100 min-h-screen flex flex-col justify-between text-gray-800">

  <!-- Navigation Bar -->
  <nav class="nav-with-slide text-white py-3 px-6 flex items-center justify-between shadow-md">
    <div class="brand">
      <img src="https://assets.onecompiler.app/3zky9aw9p/43fpymfcg/20250422_195741.png" alt="Thinklator Logo">
   <span class="brand-text font-bold text-white text-xl ml-[127px]" style="font-family: 'Abril Fatface', cursive;">Thinklator</span>
    </div>
    <div class="space-x-4 text-sm sm:text-base nav-content">
      <!-- Navigation links (optional) -->
    </div>
  </nav>

  <!-- Header -->
  <header class="text-center mt-6 select-none">
    <h1 class="text-green-800 font-bold text-xl -mt-5" style="font-family: 'Abril Fatface', cursive;">Your Welcome</h1>
    <p class="text-green-800 font-bold -mt-1">рооро╛род ро╡роЯрпНроЯро┐ роХрогро┐рокрпНрокро╛ройрпН</p>
  </header>

  <!-- Calculator -->
  <main class="flex justify-center mt-8 px-4">
    <div id="calcCard" class="bg-white p-6 rounded-3xl shadow-md w-full max-w-md space-y-6">
      <!-- Inputs -->
      <div class="space-y-5">
        <div>
          <label for="amount" class="block text-green-700 font-bold">роорпБродро▓рпАроЯрпБ родрпКроХрпИ (тВ╣)</label>
          <input id="amount" type="number"
            class="w-full border-b-2 border-green-500 focus:outline-none p-2 bg-transparent text-green-900"/>
        </div>
        <div>
          <label for="rate" class="block text-green-700 font-bold">рооро╛род ро╡роЯрпНроЯро┐ ро╡ро┐роХро┐родроорпН (%)</label>
          <input id="rate" type="number" step="0.01"
            class="w-full border-b-2 border-green-500 focus:outline-none p-2 bg-transparent text-green-900"/>
        </div>
        <div>
          <label for="months" class="block text-green-700 font-bold">роХро╛ро▓ роЕро╡роХро╛роЪроорпН (рооро╛родроЩрпНроХро│ро┐ро▓рпН)</label>
          <input id="months" type="number"
            class="w-full border-b-2 border-green-500 focus:outline-none p-2 bg-transparent text-green-900"/>
        </div>
      </div>

      <!-- Button -->
      <button onclick="calculate()" class="shimmer w-full py-3 rounded-xl font-semibold tracking-wide">
        роХрогроХрпНроХро┐роЯрпБ
      </button>

      <!-- Results (Original) -->
      <div id="resultSection" class="mt-6 space-y-6"></div>
    </div>
  </main>

  <!-- Receipt Section (Initially Hidden) -->
  <div id="receiptContainerWrapper" class="mt-8 flex flex-col items-center">
    <div class="receipt-container">

        <!-- Top Green Section -->
        <div class="green-section-bg">
            <div class="receipt-header">
                <div class="brand-receipt">
                    <img src="https://assets.onecompiler.app/3zky9aw9p/43fpymfcg/20250422_195741.png" alt="Thinklator Logo" class="brand-logo">
                    <h2 class="english-font">Thinklator</h2>
                </div>
                <p class="receipt-title">ро╡роЯрпНроЯро┐ роХрогроХрпНроХрпАроЯрпБ ро░роЪрпАродрпБ</p>
            </div>

            <div class="date-time-section">
                <p class="date-time" id="receiptDateTime">--</p>
            </div>
        </div>
        <div class="dashed-separator"></div>


        <!-- Middle Sections (No green background) -->
        <div class="section">
            <h3 class="section-title">роХрогроХрпНроХрпАроЯрпНроЯрпБ ро╡ро┐ро╡ро░роЩрпНроХро│рпН</h3>
            <div class="detail-row">
                <span class="label">роорпБродро▓рпАроЯрпНроЯрпБ родрпКроХрпИ:</span>
                <span class="value" id="receiptAmountValue">--</span>
            </div>
            <div class="detail-row">
                <span class="label">рооро╛род ро╡роЯрпНроЯро┐ ро╡ро┐роХро┐родроорпН:</span>
                <span class="value" id="receiptRateValue">--</span>
            </div>
            <div class="detail-row">
                <span class="label">роХро╛ро▓ роЕро╡роХро╛роЪроорпН:</span>
                <span class="value" id="receiptMonthsValue">--</span>
            </div>
        </div>
        <div class="dashed-separator"></div>


        <div class="section">
            <h3 class="section-title">роорпБроЯро┐ро╡рпБроХро│рпН</h3>
             <div class="detail-row">
                <span class="label">рооро╛родро╛роирпНродро┐ро░ ро╡роЯрпНроЯро┐:</span>
                <span class="value" id="receiptMonthlyInterestValue">--</span>
            </div>
             <div class="detail-row">
                <span class="label">роорпКродрпНрод ро╡роЯрпНроЯро┐:</span>
                <span class="value" id="receiptTotalInterestValue">--</span>
            </div>
        </div>
        <div class="dashed-separator"></div>

         <!-- Final Amount Section -->
         <div class="section final-amount-section">
             <div class="final-amount-row-item">
                 <span class="label">роЗро▒рпБродро┐ родрпКроХрпИ:</span>
                 <span class="value" id="receiptTotalAmountValue">--</span>
             </div>
        </div>
        <div class="dashed-separator"></div>

        <!-- Footer Section -->
        <div class="green-section-bg">
             <div class="receipt-footer-content">
                 <p>роЗроирпНрод ро░роЪрпАродрпБ Thinklator роорпВро▓роорпН роЙро░рпБро╡ро╛роХрпНроХрокрпНрокроЯрпНроЯродрпБ</p>
                 <p class="english-font">┬й 2024 Thinklator - роЙроЩрпНроХро│рпН роиро┐родро┐ роХрогроХрпНроХрпАроЯрпБроХро│рпБроХрпНроХро╛рой роироорпНрокроХрооро╛рой роХро░рпБро╡ро┐</p>
             </div>
        </div>

    </div>

    <!-- Download Button -->
    <button class="download-button w-full max-w-md py-3 rounded-xl font-semibold tracking-wide" id="downloadPdfBtn">
         <!-- Download Icon (Font Awesome) -->
        <i class="fas fa-download"></i>
         PDF роЖроХ рокродро┐ро╡ро┐ро▒роХрпНроХрпБ
    </button>
  </div>

  <!-- Footer -->
  <footer class="bg-green-100 text-green-800 text-center py-3 mt-10 footer-animate">
    <a href="https://evanjeevan07.github.io/Portfolio/" class="text-green-800 hover:underline">Devloped By ЁЭЩ┤ЁЭЪЕ ЁЭЪВЁЭЩ░ЁЭЩ╜ЁЭЩ╣ЁЭЩ┤ЁЭЩ┤ЁЭЪЕЁЭЩ░ЁЭЩ╜</a>
  </footer>

  <!-- html2pdf.js library (includes html2canvas and jsPDF) -->
  <!-- Make sure ONLY THIS SCRIPT IS LOADED for PDF generation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <!-- JavaScript -->
  <script>
    // Tamil number conversion functions
    const U = ["","роТройрпНро▒рпБ","роЗро░рогрпНроЯрпБ","роорпВройрпНро▒рпБ","роиро╛ройрпНроХрпБ","роРроирпНродрпБ","роЖро▒рпБ","роПро┤рпБ","роОроЯрпНроЯрпБ","роТройрпНрокродрпБ"];
    const T = ["","рокродрпНродрпБ","роЗро░рпБрокродрпБ","роорпБрокрпНрокродрпБ","роиро╛ро▒рпНрокродрпБ","роРроорпНрокродрпБ","роЕро▒рпБрокродрпБ","роОро┤рпБрокродрпБ","роОрогрпНрокродрпБ","родрпКрогрпНрогрпВро▒рпБ"]; /* Corrected роиро╛рокрпНрокродрпБ to роиро╛ро▒рпНрокродрпБ */

    function bH(n){
      if(n < 10) return U[n];
      if(n < 20) return ["","рокродро┐ройрпКройрпНро▒рпБ","рокройро┐ро░рпЖрогрпНроЯрпБ","рокродро┐роорпВройрпНро▒рпБ","рокродро┐ройро╛ройрпНроХрпБ","рокродро┐ройрпИроирпНродрпБ",
        "рокродро┐ройро╛ро▒рпБ","рокродро┐ройрпЗро┤рпБ","рокродро┐ройрпЖроЯрпНроЯрпБ","рокродрпНродрпКройрпНрокродрпБ"][n - 10] || "рокродрпНродрпБ";
      const t = Math.floor(n / 10), u = n % 10;
      return T[t] + (u ? ` ${U[u]}` : "");
    }

    function bT(n){
      const h = Math.floor(n / 100), r = n % 100;
      if (h === 1 && r === 0) return "роирпВро▒рпБ"; // Handle exactly 100
      return (h ? `${U[h]}${h > 1 ? " " : ""}роирпВро▒рпБ${r ? " " : ""}` : "") + (r ? bH(r) : "");
    }

     function taWords(num){
      if (isNaN(num)) return "родро╡ро▒ро╛рой рокродро┐ро╡рпБ";
      if (num < 0) return "рокрпВроЬрпНропродрпНродро┐ро▒рпНроХрпБроорпН роХрпБро▒рпИро╡ро╛ройродрпБ";
      if (num === 0) return "рокрпВроЬрпНропроорпН";

      // Round to 2 decimal places for currency and handle as integer/decimal parts
      const numStr = num.toFixed(2);
      const [integerPart, decimalPart] = numStr.split('.');
      const intNum = parseInt(integerPart, 10);
      const decNum = parseInt(decimalPart, 10);

      const c = Math.floor(intNum / 1e7);
      const l = Math.floor((intNum % 1e7) / 1e5);
      const th = Math.floor((intNum % 1e5) / 1e3);
      const r = intNum % 1e3; // Remainder less than 1000
      const arr = [];

      if (c) arr.push(`${bT(c)} роХрпЛроЯро┐`);
      if (l) arr.push(`${bT(l)} ро▓роЯрпНроЪроорпН`);
      if (th) arr.push(`${bT(th)} роЖропро┐ро░роорпН`);
      if (r) {
           // Use bT for the remainder part (0-999)
           if (r === 0 && intNum > 0 && arr.length > 0) {
               // If remainder is 0 and there was a larger unit, don't add anything here
           } else {
                arr.push(bT(r));
           }
      }

      let result = arr.join(" ");
       if (intNum > 0) { // Add "ро░рпВрокро╛ропрпН" only if there is a non-zero integer part
           if (result) result += " ро░рпВрокро╛ропрпН";
           else result = "ро░рпВрокро╛ропрпН"; // Case where intNum < 1000 but is > 0
       } else if (intNum === 0 && decNum > 0) {
            // If only paisa, result starts empty, don't add " ро░рпВрокро╛ропрпН"
       }

      if (decNum > 0) {
          const paisaText = bH(decNum); // Use bH for numbers up to 99 (for paisa)
          if (result && intNum > 0) { // If there was a Rupee part
              result += ` рооро▒рпНро▒рпБроорпН ${paisaText} рокрпИроЪро╛`;
          } else if (intNum === 0) { // If only paisa (e.g., 0.50)
              result = `${paisaText} рокрпИроЪро╛`;
          } else { // This case should be covered by the intNum > 0 check above
               result += ` рооро▒рпНро▒рпБроорпН ${paisaText} рокрпИроЪро╛`;
          }
      } else if (intNum > 0 && decNum === 0) {
           // Ensure "ро░рпВрокро╛ропрпН" is added even if decimal part is 0, if int part is > 0
            if (!result.includes(" ро░рпВрокро╛ропрпН")) {
               // This case is mostly handled above, but as a fallback:
               if (result) result += " ро░рпВрокро╛ропрпН";
               else result = "ро░рпВрокро╛ропрпН";
            }
       }

        // Handle edge case for exactly 0.00
        if (intNum === 0 && decNum === 0) {
            result = "рокрпВроЬрпНропроорпН";
        }

       // Clean up potential extra space before "ро░рпВрокро╛ропрпН" or "рокрпИроЪро╛"
       result = result.replace(/\s+ро░рпВрокро╛ропрпН/, " ро░рпВрокро╛ропрпН").replace(/\s+рооро▒рпНро▒рпБроорпН/, " рооро▒рпНро▒рпБроорпН").trim();

      return result || "рокрпВроЬрпНропроорпН"; // Return "рокрпВроЬрпНропроорпН" if result is empty (e.g., 0.00)
    }


    // Get element references
    const amountInput = document.getElementById('amount');
    const rateInput = document.getElementById('rate');
    const monthsInput = document.getElementById('months');
    const resultSection = document.getElementById('resultSection');
    const receiptContainerWrapper = document.getElementById('receiptContainerWrapper');
    const receiptContainer = document.querySelector('.receipt-container');

    // Get receipt element references
    const receiptDateTime = document.getElementById('receiptDateTime');
    const receiptAmountValue = document.getElementById('receiptAmountValue');
    const receiptRateValue = document.getElementById('receiptRateValue');
    const receiptMonthsValue = document.getElementById('receiptMonthsValue');
    const receiptMonthlyInterestValue = document.getElementById('receiptMonthlyInterestValue');
    const receiptTotalInterestValue = document.getElementById('receiptTotalInterestValue');
    const receiptTotalAmountValue = document.getElementById('receiptTotalAmountValue');

    const downloadPdfBtn = document.getElementById('downloadPdfBtn');


    function calculate(){
      const amount = +amountInput.value;
      const rate = +rateInput.value;
      const months = +monthsInput.value;

      // Basic validation
      if (isNaN(amount) || amount < 0 || isNaN(rate) || rate < 0 || isNaN(months) || months <= 0) {
          alert("родропро╡рпБ роЪрпЖропрпНродрпБ роЪро░ро┐ропро╛рой роОрогрпН роородро┐рокрпНрокрпБроХро│рпИ роЙро│рпНро│ро┐роЯро╡рпБроорпН!");
          // Hide results and receipt if inputs are invalid
          resultSection.innerHTML = '';
          receiptContainerWrapper.style.display = 'none';
          return;
      }

      // Clear previous results before calculating and showing new ones
      resultSection.innerHTML = '';
      receiptContainerWrapper.style.display = 'none';


      const mi = (amount * rate) / 100; // Monthly Interest
      const ti = mi * months; // Total Interest
      const total = amount + ti; // Total Amount

      const items = [
        { label: "роорпБродро▓рпАроЯрпБ", value: amount },
        { label: "рооро╛родро╛роирпНродро┐ро░ ро╡роЯрпНроЯро┐", value: mi },
        { label: "роорпКродрпНрод ро╡роЯрпНроЯро┐", value: ti },
        { label: "роорпКродрпНрод родрпКроХрпИ", value: total }
      ];

      // --- Update Original Results Section ---
      const numberSection = items.map(item => `
        <div class="flex justify-between border-b border-green-300 pb-1">
          <span>${item.label}:</span>
          <span class="text-right">тВ╣${item.value.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</span>
        </div>
      `).join("");

      const tamilSection = items.map(item => `
        <div class="flex justify-between border-b border-green-300 pb-1">
          <span>${item.label}:</span>
          <span class="text-right">${taWords(item.value)}</span>
        </div>
      `).join("");

      resultSection.innerHTML = `
        <div id="numberOutputBox" class="bg-green-200 p-4 rounded-xl text-green-900 shadow space-y-3 border border-green-400">
          <div class="text-xl font-bold text-center mb-1 border-b border-green-500 pb-1">роОрогрпНроХро│рпН</div>
          ${numberSection}
        </div>
        <div class="bg-green-200 p-4 rounded-xl text-green-900 shadow space-y-3 border border-green-400">
          <div class="text-xl font-bold text-center mb-1 border-b border-green-500 pb-1">родрооро┐ро┤ро┐ро▓рпН</div>
          ${tamilSection}
        </div>
      `;

      // --- Update Receipt Section ---
      const now = new Date();
      // Format date and time for the receipt (e.g., "2024-05-18 роЕройрпНро▒рпБ 11:42 PM")
      const dateTimeString = now.toLocaleDateString('en-CA') + ' роЕройрпНро▒рпБ ' +
                             now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true }); /* Added hour12: true */
      receiptDateTime.textContent = dateTimeString;

      receiptAmountValue.textContent = `тВ╣${amount.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
      receiptRateValue.textContent = `${rate}%`;
      receiptMonthsValue.textContent = `${months} рооро╛родроЩрпНроХро│рпН`;
      receiptMonthlyInterestValue.textContent = `тВ╣${mi.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
      receiptTotalInterestValue.textContent = `тВ╣${ti.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
      receiptTotalAmountValue.textContent = `тВ╣${total.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;

      // Show the receipt section wrapper
      receiptContainerWrapper.style.display = 'flex'; /* Used 'flex' as per CSS */
    }

    // --- Event Listener to Hide Outputs on Input Change ---
    function hideOutputOnInput() {
        resultSection.innerHTML = ''; // Clear original results div
        receiptContainerWrapper.style.display = 'none'; // Hide receipt section wrapper
    }

    amountInput.addEventListener('input', hideOutputOnInput);
    rateInput.addEventListener('input', hideOutputOnInput);
    monthsInput.addEventListener('input', hideOutputOnInput);


    // --- PDF Download Button Logic using html2pdf.js ---
    downloadPdfBtn.addEventListener('click', function() {
        console.log("Download button clicked.");

        // Check if html2pdf is loaded
        if (typeof html2pdf === 'undefined') {
            console.error("html2pdf.js library is not loaded.");
            alert("PDF роЙро░рпБро╡ро╛роХрпНроХ родрпЗро╡рпИропро╛рой ро▓рпИрокрпНро░ро░ро┐ ро▓рпЛроЯрпН роЖроХро╡ро┐ро▓рпНро▓рпИ. роЗрогрпИроп роЗрогрпИрокрпНрокрпИ роЪро░ро┐рокро╛ро░рпНродрпНродрпБ роорпАрогрпНроЯрпБроорпН роорпБропро▒рпНроЪро┐роХрпНроХро╡рпБроорпН.");
            return;
        }

        // Ensure the receipt container element is available
        if (!receiptContainer) {
            console.error("Receipt container element not found.");
            alert("ро░роЪрпАродрпБ роЙро│рпНро│роЯроХрпНроХродрпНродрпИ роХрогрпНроЯрпБрокро┐роЯро┐роХрпНроХ роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ.");
            return;
        }

        // Temporarily remove box-shadow and border for better rendering in canvas
        // Store original styles to restore later
        const originalBoxShadow = receiptContainer.style.boxShadow;
        const originalBorder = receiptContainer.style.border;
        receiptContainer.style.boxShadow = 'none';
        receiptContainer.style.border = 'none';

        console.log("Attempting PDF generation...");

        // Configuration for html2pdf
        const options = {
            margin: 10, // 10mm margin around the content
            filename: 'Thinklator_Interest_Receipt.pdf', // Safe filename
            image: { type: 'png', quality: 1.0 }, // Use PNG for potentially better quality
            html2canvas: { scale: 3, useCORS: true, logging: true }, // useCORS is important for external images
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
        };

        // Use html2pdf to generate and save the PDF
        // Target only the receipt div
        html2pdf().from(receiptContainer).set(options).save().then(() => {
             console.log("PDF generated successfully.");
        }).catch(error => {
             console.error("Error generating PDF:", error);
             // Provide a more detailed error message based on potential issues
             let errorMessage = "PDF роЙро░рпБро╡ро╛роХрпНроХ роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ.";
             if (error && (error.message && error.message.includes("Failed to fetch") || (error.name && error.name === "NetworkError"))) {
                 errorMessage += " роЗрогрпИрокрпНрокро┐ро▓рпЛ роЕро▓рпНро▓родрпБ рокроЯроЩрпНроХро│рпИ ро▓рпЛроЯрпН роЪрпЖропрпНро╡родро┐ро▓рпЛ роЪро┐роХрпНроХро▓рпН роЗро░рпБроХрпНроХро▓ро╛роорпН. ро▓рпЛроХрпЛ рокроЯродрпНродрпИ роЙроЩрпНроХро│рпН GitHub ро░рпЖрокрпНрокрпЛро╡ро┐ро▓рпН роирпЗро░роЯро┐ропро╛роХ ро╣рпЛро╕рпНроЯрпН роЪрпЖропрпНродрпБ роорпБропро▒рпНроЪро┐роХрпНроХро╡рпБроорпН."; // Added suggestion
             } else if (error && error.message && error.message.includes("html2canvas")) {
                  errorMessage += " ро░роЪрпАродро┐ройрпН ро╡роЯро┐ро╡роорпИрокрпНрокрпИ (CSS) ро░рпЖрогрпНроЯро░рпН роЪрпЖропрпНро╡родро┐ро▓рпН роЪро┐роХрпНроХро▓рпН роЗро░рпБроХрпНроХро▓ро╛роорпН.";
             } else {
                  errorMessage += " роХройрпНроЪрпЛро▓ро┐ро▓рпН роЙро│рпНро│ рокро┐ро┤рпИроХро│рпИ роЪро░ро┐рокро╛ро░рпНроХрпНроХро╡рпБроорпН.";
             }
             alert(errorMessage);

        }).finally(() => {
             // Always restore box-shadow and border after generation attempt
             receiptContainer.style.boxShadow = originalBoxShadow;
             receiptContainer.style.border = originalBorder;
        });
    });

    // Initial state: Hide/Clear outputs on page load
    document.addEventListener('DOMContentLoaded', function() {
       receiptContainerWrapper.style.display = 'none'; // Hide receipt section
       resultSection.innerHTML = ''; // Ensure the original results div is empty on load
    });

  </script>
</body>
</html>
